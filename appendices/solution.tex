\section{棋谱}\label{app:solution}

Optimal solution for the standard 华容道 (横刀立马,
\cref{sec:huarongdao}). A \emph{turn} (步) engages a different
piece; arrows show each unit translation within the turn.
Shading matches the board diagram (\cref{def:huarongdao});
king turns in \textbf{bold}.
Solver: \texttt{solver/hrd\_solution.py}.

% ── Piece-type shading (matching board diagram grey levels) ──
\newcommand{\pk}[1]{\colorbox{black!80}{\textcolor{white}{#1}}}%  王
\newcommand{\pd}[1]{\colorbox{black!55}{\textcolor{white}{#1}}}%  刀
\newcommand{\pj}[1]{\colorbox{black!35}{\textcolor{white}{#1}}}%  将
\newcommand{\pz}[1]{\colorbox{black!12}{#1}}%                     卒
\setlength{\fboxsep}{1.5pt}

\medskip
\noindent
\begin{tabular}{@{}rl@{\quad}rl@{}}
\pk{操} & 曹操\;(王, $2{\times}2$) &
\pj{飞}\;\pj{云}\;\pj{超}\;\pj{忠} & generals\;($1{\times}2$) \\
\pd{羽} & 关羽\;(刀, $2{\times}1$) &
\pz{\textcircled{\small 1}}\;\pz{\textcircled{\small 2}}\;\pz{\textcircled{\small 3}}\;\pz{\textcircled{\small 4}}
  & soldiers\;($1{\times}1$) \\
\end{tabular}

\smallskip\noindent
Soldier positions (board diagram, \cref{def:huarongdao}):\;
\textcircled{\small 1}\,$(1,1)$,\;
\textcircled{\small 2}\,$(2,1)$,\;
\textcircled{\small 3}\,$(0,0)$,\;
\textcircled{\small 4}\,$(3,0)$.

\medskip
\noindent
81 turns $=$ 9~王 $+$ 72~水.\quad
118 unit translations.\quad 9~phases.

\bigskip
\noindent
\begin{minipage}[t]{0.30\textwidth}
\centering\small
\begin{tabular}[t]{@{}rl@{}}
\toprule
\# & Turn \\
\midrule
 1 & \pz{\textcircled{\small 1}$\downarrow$} \\
 2 & \pz{\textcircled{\small 4}$\leftarrow$} \\
 3 & \pj{忠$\downarrow$} \\
 4 & \pd{羽$\rightarrow$} \\
 5 & \pj{超$\rightarrow$} \\
 6 & \pz{\textcircled{\small 3}$\uparrow$} \\
 7 & \pz{\textcircled{\small 1}$\leftarrow$} \\
 8 & \pj{超$\downarrow$} \\
 9 & \pd{羽$\leftarrow\!\leftarrow$} \\
10 & \pz{\textcircled{\small 2}$\uparrow\!\rightarrow$} \\
11 & \pz{\textcircled{\small 4}$\uparrow\!\uparrow$} \\
12 & \pj{超$\rightarrow$} \\
13 & \pz{\textcircled{\small 3}$\rightarrow\!\downarrow$} \\
14 & \pd{羽$\downarrow$} \\
15 & \pz{\textcircled{\small 4}$\leftarrow\!\leftarrow$} \\
16 & \pz{\textcircled{\small 2}$\leftarrow\!\leftarrow$} \\
17 & \pj{超$\uparrow$} \\
18 & \pj{忠$\uparrow$} \\
19 & \pz{\textcircled{\small 3}$\rightarrow\!\rightarrow$} \\
20 & \pz{\textcircled{\small 1}$\rightarrow\!\rightarrow$} \\
21 & \pd{羽$\downarrow$} \\
22 & \pz{\textcircled{\small 2}$\downarrow\!\leftarrow$} \\
23 & \pj{超$\leftarrow$} \\
24 & \pj{忠$\leftarrow$} \\
25 & \pj{云$\downarrow\!\downarrow$} \\
\textbf{26} & \pk{\textbf{操$\rightarrow$}} \\
\addlinespace[4pt]
27 & \pj{飞$\rightarrow$} \\
\bottomrule
\end{tabular}
\end{minipage}\hfill
%
\begin{minipage}[t]{0.30\textwidth}
\centering\small
\begin{tabular}[t]{@{}rl@{}}
\toprule
\# & Turn \\
\midrule
28 & \pz{\textcircled{\small 4}$\uparrow\!\uparrow$} \\
29 & \pz{\textcircled{\small 2}$\uparrow\!\uparrow$} \\
30 & \pj{超$\leftarrow$} \\
31 & \pj{飞$\downarrow\!\downarrow$} \\
\textbf{32} & \pk{\textbf{操$\leftarrow$}} \\
\addlinespace[4pt]
33 & \pj{云$\uparrow\!\uparrow$} \\
34 & \pj{忠$\rightarrow$} \\
35 & \pz{\textcircled{\small 1}$\uparrow\!\uparrow$} \\
36 & \pz{\textcircled{\small 3}$\leftarrow\!\uparrow$} \\
37 & \pd{羽$\rightarrow\!\rightarrow$} \\
38 & \pj{飞$\downarrow$} \\
39 & \pj{超$\downarrow$} \\
40 & \pz{\textcircled{\small 1}$\leftarrow\!\leftarrow$} \\
\textbf{41} & \pk{\textbf{操$\downarrow$}} \\
\addlinespace[4pt]
42 & \pz{\textcircled{\small 4}$\rightarrow\!\rightarrow$} \\
43 & \pz{\textcircled{\small 2}$\uparrow\!\rightarrow$} \\
44 & \pz{\textcircled{\small 1}$\uparrow\!\uparrow$} \\
45 & \pj{超$\uparrow\!\uparrow$} \\
46 & \pj{飞$\leftarrow$} \\
47 & \pz{\textcircled{\small 3}$\leftarrow\!\downarrow$} \\
\textbf{48} & \pk{\textbf{操$\downarrow$}} \\
\addlinespace[4pt]
49 & \pz{\textcircled{\small 4}$\downarrow\!\leftarrow$} \\
50 & \pj{云$\leftarrow$} \\
51 & \pj{忠$\uparrow\!\uparrow$} \\
\textbf{52} & \pk{\textbf{操$\rightarrow$}} \\
\addlinespace[4pt]
53 & \pz{\textcircled{\small 4}$\downarrow\!\downarrow$} \\
54 & \pz{\textcircled{\small 2}$\downarrow$} \\
\bottomrule
\end{tabular}
\end{minipage}\hfill
%
\begin{minipage}[t]{0.30\textwidth}
\centering\small
\begin{tabular}[t]{@{}rl@{}}
\toprule
\# & Turn \\
\midrule
55 & \pz{\textcircled{\small 1}$\rightarrow$} \\
56 & \pj{超$\uparrow$} \\
57 & \pj{飞$\uparrow$} \\
58 & \pz{\textcircled{\small 3}$\leftarrow$} \\
59 & \pz{\textcircled{\small 4}$\downarrow$} \\
\textbf{60} & \pk{\textbf{操$\leftarrow$}} \\
\addlinespace[4pt]
61 & \pj{忠$\downarrow\!\downarrow$} \\
62 & \pj{云$\rightarrow$} \\
63 & \pz{\textcircled{\small 1}$\rightarrow$} \\
64 & \pz{\textcircled{\small 2}$\rightarrow$} \\
65 & \pj{超$\rightarrow$} \\
66 & \pj{飞$\uparrow\!\uparrow$} \\
\textbf{67} & \pk{\textbf{操$\leftarrow$}} \\
\addlinespace[4pt]
68 & \pz{\textcircled{\small 2}$\downarrow\!\downarrow$} \\
69 & \pz{\textcircled{\small 1}$\downarrow\!\downarrow$} \\
70 & \pj{云$\leftarrow$} \\
71 & \pj{忠$\uparrow\!\uparrow$} \\
72 & \pz{\textcircled{\small 2}$\rightarrow\!\uparrow$} \\
73 & \pd{羽$\uparrow$} \\
74 & \pz{\textcircled{\small 4}$\rightarrow\!\rightarrow$} \\
75 & \pz{\textcircled{\small 3}$\rightarrow\!\rightarrow$} \\
\textbf{76} & \pk{\textbf{操$\downarrow$}} \\
\addlinespace[4pt]
77 & \pz{\textcircled{\small 1}$\leftarrow\!\leftarrow$} \\
78 & \pz{\textcircled{\small 2}$\leftarrow\!\leftarrow$} \\
79 & \pd{羽$\uparrow$} \\
80 & \pz{\textcircled{\small 3}$\uparrow\!\rightarrow$} \\
\textbf{81} & \pk{\textbf{操$\rightarrow$}} \\
\bottomrule
\end{tabular}
\end{minipage}

\bigskip

\noindent\textbf{Phase decomposition.}\quad
Each phase ends with one king turn; the preceding turns are
水~(water preparing the path).

\medskip
\begin{center}
\small
\begin{tabular}{@{}crclc@{}}
\toprule
Phase & 水 & 王 & Direction & 操 position \\
\midrule
1 & 25 & 26 & $\rightarrow$ & $(2,3)$ \\
2 &  5 & 32 & $\leftarrow$ & $(1,3)$ \\
3 &  8 & 41 & $\downarrow$ & $(1,2)$ \\
4 &  6 & 48 & $\downarrow$ & $(1,1)$ \\
5 &  3 & 52 & $\rightarrow$ & $(2,1)$ \\
6 &  7 & 60 & $\leftarrow$ & $(1,1)$ \\
7 &  6 & 67 & $\leftarrow$ & $(0,1)$ \\
8 &  8 & 76 & $\downarrow$ & $(0,0)$ \\
9 &  4 & 81 & $\rightarrow$ & $(1,0) = E$ \\
\midrule
$\Sigma$ & 72 & 9 & & \\
\bottomrule
\end{tabular}
\end{center}

\noindent
Phase~1 (25~water turns before the first king move) is the
ceremony of 义释曹操 (\cref{rem:guanyu}): the entire board
rearranges to let 关羽 yield, before 操 takes a single step.
